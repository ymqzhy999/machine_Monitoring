# 设备效能监控系统 - 计算公式集

## OEE（设备综合效率）相关公式

### 1. OEE计算
```
OEE = (可用性 × 性能效率 × 质量) / 10000
```

### 2. 可用性计算
```
可用性 = (运行时间 / 计划生产时间) × 100%
```
或实际实现中：
```
可用性 = (运行状态记录数 / 总记录数) × 100%
```

### 3. 性能效率计算
```
性能效率 = (实际产出 / 理论产出) × 100%
```
或基于设备运行时间：
```
性能效率 = (理想运行时间 / 平均运行时间) × 100%
```
其中，理想运行时间通常设定为最短运行时间的90%：
```
理想运行时间 = 最短运行时间 × 0.9
```

### 4. 质量计算
```
质量 = (合格产品数量 / 总产品数量) × 100%
```

### 5. TEEP（总体设备效能）计算
```
TEEP = OEE × 设备利用率 / 100%
```
其中，设备利用率简化计算为：
```
设备利用率 = 可用性 × 0.95
```
并限制最大值为98%

### 6. 停机时间（分钟）近似计算
```
停机时间 = (100 - 可用性) × 0.6
```

## 资源利用率分析

### 1. 设备利用率
```
设备利用率 = (各状态时间占比)
```
例如：{'运行中': 85.2%, '待机': 8.6%, '维护': 4.5%, '故障': 1.7%}

### 2. 物料利用率
```
物料利用率 = (总产量 - 不合格品) / 总投入物料量
```

### 3. 人员效能分析

#### 操作熟练度
```
熟练度得分 = 熟练度 × 100
```

#### 操作效率
```
效率得分 = (熟练度 × 70% + 操作时长评分 × 30%)
```
其中，操作时长评分计算为：
```
操作时长评分 = (1 - min(操作时长, 2) / 2) × 100
```

#### 成功率
```
成功率 = (成功操作次数 / 总操作次数) × 100%
```

## 质量分析公式

### 1. 质量率
```
质量率 = (合格产品数 / 总产品数) × 100%
```

### 2. 缺陷率
```
缺陷率 = 100% - 质量率
```

### 3. 过程能力指数(Cpk)
```
Cpk = 1.0 + 质量率/100
```

### 4. 过程性能指数(Ppk)
```
Ppk = 0.9 + 质量率/110
```

### 5. Sigma水平
```
Sigma = 3 + 质量率/100 × 3
```

### 6. 质量成本
```
内部失败成本 = (总产品数 - 合格产品数) × 平均产品成本 × 0.3
外部失败成本 = (总产品数 - 合格产品数) × 平均产品成本 × 0.5
检验成本 = 总产品数 × 平均产品成本 × 0.05
预防成本 = 总产品数 × 平均产品成本 × 0.02
总质量成本 = 内部失败成本 + 外部失败成本 + 检验成本 + 预防成本
```

## 时间分析公式

### 1. 时间分类
```
设备时间 = 运行时间 + 停机时间 + 维护时间
```

### 2. 设备利用率
```
设备利用率 = (运行时间 / 设备时间) × 100%
```

## 瓶颈分析公式

### 1. 设备瓶颈指数
```
瓶颈指数 = (故障次数 × 0.4 + 停机时间 × 0.4 + 预警频率 × 0.2)
```

### 2. 设备平衡指数
```
平衡指数 = 标准差(各设备产能) / 平均产能
```
平衡指数越小，生产线越平衡

### 3. 设备关键度评分
```
关键度评分 = (停机时间 × 生产线依赖度 × 产能占比)
```

### 4. 瓶颈影响程度
```
瓶颈影响程度 = (瓶颈设备停机时间 / 总生产时间) × 100%
```

### 5. 瓶颈改善潜力
```
改善潜力 = (当前瓶颈指数 - 目标瓶颈指数) × 产能贡献率
```

## 预测分析公式

### 1. 简单移动平均预测
```
预测值(t+1) = (观测值(t) + 观测值(t-1) + ... + 观测值(t-n+1)) / n
```

### 2. 指数平滑预测
```
预测值(t+1) = α × 观测值(t) + (1-α) × 预测值(t)
```
其中，α为平滑系数，通常取0.1-0.3之间的值

### 3. 线性趋势预测
```
预测值(t+h) = a + b × (t+h)
```
其中，a为截距，b为斜率，使用历史数据拟合得到

### 4. 故障预测概率
```
故障概率 = 1 - e^(-λ × t)
```
其中，λ为故障率参数，t为运行时间

### 5. 剩余使用寿命(RUL)估计
```
RUL = (退化阈值 - 当前退化水平) / 退化率
```

## 异常检测公式

### 1. Z-Score异常判定
```
Z-Score = (观测值 - 平均值) / 标准差
```
如果|Z-Score| > 3，则判定为异常

### 2. 基于IQR的异常检测
```
IQR = Q3 - Q1
下限 = Q1 - 1.5 × IQR
上限 = Q3 + 1.5 × IQR
```
如果观测值 < 下限 或 观测值 > 上限，则判定为异常

### 3. 振动异常评分
```
振动异常评分 = (当前振动值 - 基线振动值) / 基线振动值 × 100%
```

### 4. 环境异常指数
```
温度异常指数 = max(0, (温度 - 温度上限) / 5) + max(0, (温度下限 - 温度) / 5)
湿度异常指数 = max(0, (湿度 - 湿度上限) / 10) + max(0, (湿度下限 - 湿度) / 10)
```

### 5. 多参数综合异常评分
```
综合异常评分 = w1 × 温度异常指数 + w2 × 湿度异常指数 + w3 × 振动异常评分 + w4 × 噪音异常评分
```
其中，w1, w2, w3, w4为各参数的权重 